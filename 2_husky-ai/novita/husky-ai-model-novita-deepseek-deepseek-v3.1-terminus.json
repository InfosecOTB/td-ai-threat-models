{
  "summary": {
    "title": "Husky AI",
    "owner": "",
    "description": "A machine learning system to classify Huskies vs dogs. HuskyAI is a machine learning system designed to classify images and distinguish between huskies and non-huskies. It integrates secure data handling practices with a robust convolutional neural network (CNN) for image recognition. Secure Image Retrieval: HuskyAI uses TLS to securely fetch images from Azure Cognitive Services, ensuring encryption during data transmission and validating the server's authenticity to prevent man-in-the-middle attacks. Data Storage and Access Controls: Azure Blob Storage is used to store datasets, with public access fully blocked. Access is controlled using Role-Based Access Control (rbac) and Attribute-Based Access Control (ABAC) to enforce granular, identity-based permissions. Jupyter Notebooks, which host model development and experimentation, are also secured with rbac and ABAC, preventing unauthorized public access. Developer Authentication: Developers access the system through SSH keys protected by passphrases. This adds an additional layer of security, reducing the likelihood of unauthorized access even if keys are exposed. Model and Dataset Dataset Composition: The dataset comprises approximately 1,300 husky images and 3,000 non-husky images sourced via Bing's image search. Data undergoes manual cleansing and is split into training and validation sets to enhance model performance. Model Design: HuskyAI employs a CNN with: Convolutional layers for feature extraction. Max-pooling layers for dimensionality reduction. Dropout layers to prevent overfitting. Dense layers for final classification. The model is trained with the Adam optimizer and a learning rate of 0.0005, optimized for accuracy and computational efficiency. Security Considerations rbac and ABAC controls across storage and development environments ensure sensitive data and configurations are protected. TLS ensures secure communication channels, preventing eavesdropping or data interception during image retrieval. Applications HuskyAI is tailored for accurate image classification and can be adapted for other domains requiring precise visual differentiation, with a focus on maintaining strong security postures. HuskyAI combines state-of-the-art machine learning techniques with stringent security controls, including secure communications, robust access management, and encrypted developer authentication, to deliver a reliable and secure image classification system.",
    "id": 0,
    "compatibility": {
      "business_criticality": "low",
      "data_sensitivity": [
        "biz"
      ],
      "exposure": "external",
      "tier": "non_critical"
    }
  },
  "detail": {
    "contributors": [
      {
        "name": "Imported from TM-BOM"
      }
    ],
    "diagrams": [
      {
        "version": "2.5.0",
        "title": "Husky AI",
        "thumbnail": "./public/content/images/thumbnail.jpg",
        "diagramType": "TM-BOM",
        "id": 0,
        "cells": [
          {
            "size": {
              "width": 150,
              "height": 80
            },
            "label": "Engineer",
            "shape": "actor",
            "zIndex": 0,
            "data": {
              "type": "tm.Actor",
              "name": "Engineer",
              "description": "A Data Engineer responsible for building, training, and deploying machine learning models.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            },
            "id": "engineer",
            "position": {
              "x": 62.5,
              "y": 62.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 80
            },
            "label": "Infra Admin",
            "shape": "actor",
            "zIndex": 1,
            "data": {
              "type": "tm.Actor",
              "name": "Infra Admin",
              "description": "Administrator responsible for securing and maintaining production infrastructure.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            },
            "id": "infrastructure-admin",
            "position": {
              "x": 62.5,
              "y": 267.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 80
            },
            "label": "Azure\nCognitive Services",
            "shape": "actor",
            "zIndex": 2,
            "data": {
              "type": "tm.Actor",
              "name": "Azure\nCognitive Services",
              "description": "External service providing resources for machine learning experimentation.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            },
            "id": "azure-cognitive-services",
            "position": {
              "x": 347.5,
              "y": 62.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 80
            },
            "label": "User",
            "shape": "actor",
            "zIndex": 3,
            "data": {
              "type": "tm.Actor",
              "name": "User",
              "description": "External user interacting with the HuskyAI system via the API Gateway.",
              "isTrustBoundary": false,
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            },
            "id": "user",
            "position": {
              "x": 62.5,
              "y": 472.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "3rd party tools\nand ML libraries"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "store",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "3rd party tools\nand ML libraries",
              "description": "External third party tools for the services",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            },
            "id": "third-party-tools",
            "position": {
              "x": 632.5,
              "y": 62.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Gather\nImages Application\n(Python)"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 0,
            "data": {
              "type": "tm.Process",
              "name": "Gather\nImages Application\n(Python)",
              "description": "This is a Python-based application responsible for gathering images from external sources, specifically Azure Cognitive Services, and storing them in the designated Training and Validation Images storage. ",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Spoofing of Azure Cognitive Services",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "The Gather Images Application receives data from Azure Cognitive Services via HTTPS. While encrypted, there is no explicit authentication mechanism described to verify the identity of the external service, which could allow an attacker to spoof the service.",
                  "mitigation": "Implement certificate pinning or service-specific API key authentication to validate the identity of Azure Cognitive Services.",
                  "modelType": "STRIDE",
                  "id": "9a0ecc80-4096-4977-bd07-85c83ad95251"
                },
                {
                  "title": "Tampering of Image Data in Transit",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Tampering",
                  "description": "The flow from Azure Cognitive Services to the Gather Images Application is encrypted (HTTPS), reducing tampering risk. However, the application itself could be targeted to modify images before storage.",
                  "mitigation": "Ensure integrity checks (e.g., hashing) on downloaded images and validate data integrity before processing and storage.",
                  "modelType": "STRIDE",
                  "id": "ba85e07a-e836-4604-a181-ae301f1b0b8e"
                },
                {
                  "title": "Information Disclosure via Engineer Access",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "The Engineer accesses the Gather Images Application via VS Code (SSH). If SSH keys are compromised, sensitive application data or operations could be exposed.",
                  "mitigation": "Enforce strong passphrase protection for SSH keys, use multi-factor authentication, and regularly rotate keys.",
                  "modelType": "STRIDE",
                  "id": "abef0975-d9be-450c-a572-5463dc44a68c"
                }
              ]
            },
            "id": "gather-images",
            "position": {
              "x": 472.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Jupyter\nNotebook"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 1,
            "data": {
              "type": "tm.Process",
              "name": "Jupyter\nNotebook",
              "description": "A Jupyter Notebook environment that processes the images stored in Training and Validation Images, executes code using external ML libraries, and provides a UI for engineers to interact with and manipulate data, allowing for iterative model development. It can save trained machine learning models to Machine Learning Model storage.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Tampering of ML Models by Engineer",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The Jupyter Notebook is accessed by the Engineer via VS Code (SSH) and can save models to storage. An authenticated but malicious insider could tamper with model training code or data.",
                  "mitigation": "Implement code review processes, version control for notebooks, and audit trails for model changes.",
                  "modelType": "STRIDE",
                  "id": "e5604a83-a577-4fe7-9b59-aa9bd5019f16"
                },
                {
                  "title": "Information Disclosure via Third-Party Libraries",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "Jupyter Notebook imports third-party tools and ML libraries. Malicious or vulnerable libraries could leak sensitive training data or model information.",
                  "mitigation": "Use dependency scanning, pin library versions, and restrict outbound network access from the notebook environment.",
                  "modelType": "STRIDE",
                  "id": "bfbb34e7-31c3-4b06-aaf7-6c103b7c47c3"
                },
                {
                  "title": "Denial of Service via Resource Exhaustion",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of Service",
                  "description": "The Jupyter Notebook processes large image datasets. An attacker or misconfiguration could cause resource exhaustion, disrupting model training.",
                  "mitigation": "Implement resource quotas, monitoring, and auto-scaling for the Jupyter environment.",
                  "modelType": "STRIDE",
                  "id": "2c2a58f5-4e22-46d2-ac92-76b742a9dc4a"
                }
              ]
            },
            "id": "jupyter",
            "position": {
              "x": 472.5,
              "y": 597.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Deployment"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 2,
            "data": {
              "type": "tm.Process",
              "name": "Deployment",
              "description": "Handles the deployment of the machine learning model by packaging the model and all necessary source code and configuration stored in Source Code and Configuration. It receives the final model from Jupyter Notebook and prepares it for deployment to the production environment.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Tampering of Deployment Packages",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The Deployment Service packages models and code from multiple sources. An attacker could tamper with these inputs or the deployment process itself, introducing malicious code into production.",
                  "mitigation": "Use cryptographic signing for deployment artifacts, verify checksums, and implement secure CI/CD pipelines with access controls.",
                  "modelType": "STRIDE",
                  "id": "6c307a71-0101-4944-b810-2d3ba1121406"
                },
                {
                  "title": "Elevation of Privilege via Bastion Access",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of Privilege",
                  "description": "The Deployment Service communicates with the Bastion via SSH. If the Bastion is compromised, an attacker could gain elevated access to the deployment process and production resources.",
                  "mitigation": "Enforce least privilege for Bastion access, use jump host auditing, and segment network access to the Deployment Service.",
                  "modelType": "STRIDE",
                  "id": "cf5beabd-8d70-4e01-955e-0281e67808dc"
                }
              ]
            },
            "id": "deployment-service",
            "position": {
              "x": 757.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "Training\nand Validation\nImages"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 3,
            "data": {
              "type": "tm.Store",
              "name": "Training\nand Validation\nImages",
              "description": "Contains images used for training and validation of machine learning models.\nData set: Training and Validation Images\nContains images used for training and validation of machine learning models.\n Record count maximum of 100000 with data sensitivity of biz and access control methods of rbac",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Information Disclosure of Training Data",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The Training and Validation Images store contains sensitive image data. While encrypted at rest, unauthorized access via misconfigured RBAC/ABAC could lead to data leakage.",
                  "mitigation": "Regularly audit access controls, encrypt data with customer-managed keys, and monitor access logs for anomalies.",
                  "modelType": "STRIDE",
                  "id": "06f8cc38-eb26-46fe-af85-e49b09814373"
                },
                {
                  "title": "Tampering of Training Dataset",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "An attacker with write access to the image store could poison the training dataset, compromising model integrity.",
                  "mitigation": "Implement immutable storage for baseline datasets, use versioning, and checksum validation for data integrity.",
                  "modelType": "STRIDE",
                  "id": "862e79a4-a6ad-487d-ba39-7fcb55ba79a3"
                }
              ]
            },
            "id": "training-images-blob",
            "position": {
              "x": 472.5,
              "y": 802.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "API Key"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "API Key",
              "description": "Stores API keys for secure access to external services.\nData set: API Keys\nStores API keys for secure access to external services.\n Record count maximum of 20 with data sensitivity of cred and access control methods of rbac",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Information Disclosure of API Keys",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The API Key storage holds credentials for external services. Unauthorized access could lead to key leakage and abuse of connected services.",
                  "mitigation": "Use a dedicated secrets management service, encrypt keys at rest and in transit, and regularly rotate keys.",
                  "modelType": "STRIDE",
                  "id": "9dab8eb9-ad36-4f29-be1b-5430be444278"
                },
                {
                  "title": "Spoofing via Stolen API Keys",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "If API keys are leaked, an attacker could spoof the Gather Images Application to Azure Cognitive Services or other external services.",
                  "mitigation": "Implement strict IP whitelisting and usage quotas on API keys, and monitor for anomalous usage.",
                  "modelType": "STRIDE",
                  "id": "33d6c88c-e8ca-48f1-9c19-d78c27eb3c7b"
                }
              ]
            },
            "id": "api-key-storage",
            "position": {
              "x": 1042.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "Machine\nLearning Model"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 5,
            "data": {
              "type": "tm.Store",
              "name": "Machine\nLearning Model",
              "description": "Contains the machine learning models in serialized format.\nData set: Bastion Logs\nContains trained machine learning models in serialized format for production use.\n Record count maximum of 5000 with data sensitivity of biz and access control methods of acl",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Tampering of Machine Learning Models",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The Machine Learning Model store contains serialized models. Unauthorized modifications could introduce backdoors or bias into production models.",
                  "mitigation": "Use model signing, version control, and access audits to prevent unauthorized changes.",
                  "modelType": "STRIDE",
                  "id": "7cf524e2-2d87-4737-a1d5-5d3faf21e500"
                },
                {
                  "title": "Information Disclosure of Model Weights",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "ML models may contain sensitive information about the training data. Unauthorized access could lead to intellectual property theft or data inference attacks.",
                  "mitigation": "Encrypt models at rest, control access with RBAC, and consider model obfuscation techniques.",
                  "modelType": "STRIDE",
                  "id": "0a21ef60-bee9-471a-8a30-03d711156cfe"
                }
              ]
            },
            "id": "ml-models",
            "position": {
              "x": 472.5,
              "y": 1007.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "Source Code\nand Configuration"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 6,
            "data": {
              "type": "tm.Store",
              "name": "Source Code\nand Configuration",
              "description": "Stores source code and configuration files for deployment and production setup.\nData set: Source Code and Configuration\nStores source code and configuration files for deployment and production setup.\n Record count maximum of 200 with data sensitivity of biz and access control methods of rbac",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Information Disclosure of Source Code",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The Source Code and Configuration store contains proprietary code and settings. A breach could expose intellectual property and system configuration details.",
                  "mitigation": "Use encrypted repositories, access controls, and regular security scans for code storage.",
                  "modelType": "STRIDE",
                  "id": "9e31d5e3-66d0-4a95-8c6e-5c2f553aeb92"
                },
                {
                  "title": "Tampering of Deployment Configuration",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "Malicious changes to configuration files could alter deployment behavior, leading to security weaknesses or system compromise.",
                  "mitigation": "Implement GitOps practices, code review, and integrity checks for configuration changes.",
                  "modelType": "STRIDE",
                  "id": "cabb52e3-fa8b-4f1c-bb1b-42463e69252a"
                }
              ]
            },
            "id": "source-code-config-storage",
            "position": {
              "x": 1327.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Simple Python\nWeb Server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 0,
            "data": {
              "type": "tm.Process",
              "name": "Simple Python\nWeb Server",
              "description": "Serves as simple web server",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Denial of Service via Public API",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Denial of Service",
                  "description": "The Simple Python Web Server is exposed to users via the API Gateway. It could be targeted with high-volume requests to exhaust resources.",
                  "mitigation": "Implement rate limiting, DDoS protection, and auto-scaling in the production zone.",
                  "modelType": "STRIDE",
                  "id": "59ff3c9b-37c3-4035-8c6d-13fcf3c79381"
                },
                {
                  "title": "Tampering of Web Server Logic",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The web server loads models and code from storage. An attacker with access to the Bastion or deployment process could modify server logic.",
                  "mitigation": "Use immutable deployments, integrity checks on loaded artifacts, and runtime protection.",
                  "modelType": "STRIDE",
                  "id": "82c652c1-5bb8-4e77-8e53-bf4fa98a799d"
                },
                {
                  "title": "Information Disclosure via Model Inference",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "The web server processes user inputs for model inference. Improper input handling could leak model details or training data patterns.",
                  "mitigation": "Sanitize inputs, implement output filtering, and monitor for anomalous query patterns.",
                  "modelType": "STRIDE",
                  "id": "e43ab8a0-1c58-4b30-a6c3-6c07b1bd9bed"
                }
              ]
            },
            "id": "web-service",
            "position": {
              "x": 1737.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "API Gateway"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 1,
            "data": {
              "type": "tm.Process",
              "name": "API Gateway",
              "description": "Serves as the entry point for external users to interact with the production environment via HTTPS. It routes user requests to the Simple Python Web Server and ensures secure communication. The API Gateway enforces request validation and manages APIs exposed to the public while ensuring access control to internal services.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Spoofing of User Requests",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "The API Gateway accepts HTTPS requests from external users. Without strong authentication, attackers could spoof user identities to access services.",
                  "mitigation": "Implement API keys, OAuth, or client certificate authentication for all incoming requests.",
                  "modelType": "STRIDE",
                  "id": "85452916-a986-40cd-a2ae-86d6c08166ed"
                },
                {
                  "title": "Tampering of API Traffic",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "While HTTPS is used, the API Gateway itself could be compromised to modify requests or responses between users and the web server.",
                  "mitigation": "Use WAF, input validation, and secure API gateway configurations to prevent tampering.",
                  "modelType": "STRIDE",
                  "id": "1b7a0ecc-ed31-401f-a682-054be2f549d4"
                },
                {
                  "title": "Denial of Service at Entry Point",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of Service",
                  "description": "As the public entry point, the API Gateway is vulnerable to DDoS attacks that could make the service unavailable.",
                  "mitigation": "Deploy DDoS protection services, rate limiting, and traffic shaping at the gateway.",
                  "modelType": "STRIDE",
                  "id": "4d17d305-e619-43f2-92ae-f677bc78f222"
                }
              ]
            },
            "id": "api-gateway",
            "position": {
              "x": 1737.5,
              "y": 597.5
            }
          },
          {
            "size": {
              "width": 100,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Bastion"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "shape": "process",
            "zIndex": 2,
            "data": {
              "type": "tm.Process",
              "name": "Bastion",
              "description": "A secure access management component for administrative functions. It provides controlled SSH access for the Infrastructure Admin to internal production resources, such as the Stored Machine Learning Model and Simple Python Web Server.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "title": "Elevation of Privilege via SSH Compromise",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of Privilege",
                  "description": "The Bastion provides SSH access for admins and deployment. If compromised, it grants extensive access to production resources, including model storage and web services.",
                  "mitigation": "Enforce MFA for SSH, use jump host isolation, and regularly audit access logs.",
                  "modelType": "STRIDE",
                  "id": "6b274cb0-7305-4e24-a587-c555cd78ca02"
                },
                {
                  "title": "Spoofing of Admin Connections",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker could spoof the Infrastructure Admin's connection to the Bastion if SSH keys are stolen or weak credentials are used.",
                  "mitigation": "Require strong passphrases for SSH keys, use certificate-based authentication, and monitor for unusual login patterns.",
                  "modelType": "STRIDE",
                  "id": "209989d5-4a4c-426c-b97e-0f5174e0e24f"
                },
                {
                  "title": "Tampering of Production Resources",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The Bastion can update the API Gateway, Web Server, and ML models. A malicious insider or compromised bastion could tamper with production systems.",
                  "mitigation": "Implement change control, multi-person approval for critical changes, and immutable infrastructure where possible.",
                  "modelType": "STRIDE",
                  "id": "d07bf678-72ef-45bd-9b92-3c7e3f6b7d9a"
                }
              ]
            },
            "id": "bastion",
            "position": {
              "x": 2022.5,
              "y": 392.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "Authorized Keys"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 3,
            "data": {
              "type": "tm.Store",
              "name": "Authorized Keys",
              "description": "Contains SSH keys used for securing administrative access.\nData set: Authorized Keys\nContains SSH keys used for securing administrative access.\n Record count maximum of 100 with data sensitivity of cred and access control methods of rbac",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": true,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Information Disclosure of SSH Keys",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The Authorized Keys store contains SSH keys for administrative access. Unauthorized disclosure could lead to full system compromise.",
                  "mitigation": "Use a dedicated secrets manager, encrypt keys at rest, and enforce regular key rotation.",
                  "modelType": "STRIDE",
                  "id": "ff809c5f-3112-43bf-9c2b-504d2b882ee2"
                },
                {
                  "title": "Spoofing via Stolen SSH Keys",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "Compromised SSH keys could allow an attacker to spoof authorized administrators and gain access to the Bastion and production systems.",
                  "mitigation": "Enforce key expiration, use hardware security modules (HSMs) for key storage, and monitor for unauthorized key usage.",
                  "modelType": "STRIDE",
                  "id": "59637333-2496-4e96-862b-bcb9b4e9218e"
                }
              ]
            },
            "id": "secret-key-storage",
            "position": {
              "x": 1737.5,
              "y": 802.5
            }
          },
          {
            "size": {
              "width": 150,
              "height": 75
            },
            "attrs": {
              "text": {
                "text": "Stored Machine\nLearning Model"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null,
                "stroke": "red"
              }
            },
            "shape": "store",
            "zIndex": 4,
            "data": {
              "type": "tm.Store",
              "name": "Stored Machine\nLearning Model",
              "description": "Contains storage for machine learning models in serialized format.\nData set: Stored Machine Learning Models\nContains trained machine learning models in serialized format for production use.\n Record count maximum of 10 with data sensitivity of biz and access control methods of rbac",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "title": "Tampering of Production Models",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The Stored Machine Learning Model in production is not encrypted at rest (isEncrypted: false). An attacker with storage access could tamper with models, affecting all predictions.",
                  "mitigation": "Enable encryption at rest for production model storage, use access controls, and implement model integrity checks.",
                  "modelType": "STRIDE",
                  "id": "1dfd5236-229b-46f9-ba3a-6dc16c627c70"
                },
                {
                  "title": "Information Disclosure of Model Artifacts",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "Production models may contain sensitive information. Unencrypted storage increases the risk of intellectual property theft if the storage is breached.",
                  "mitigation": "Encrypt all model files at rest and in transit, and restrict access using network security groups and RBAC.",
                  "modelType": "STRIDE",
                  "id": "72e8ff00-134c-460a-8f48-410673b934e5"
                }
              ]
            },
            "id": "ml-models-blob",
            "position": {
              "x": 2307.5,
              "y": 392.5
            }
          },
          {
            "position": {
              "x": 410,
              "y": 330
            },
            "size": {
              "width": 1140,
              "height": 820
            },
            "attrs": {
              "label": {
                "text": "Experimental Trust Zone"
              }
            },
            "shape": "trust-boundary-box",
            "id": "experimental-zone",
            "zIndex": -1,
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Experimental Trust Zone",
              "description": "Internal VPC with the experimental and development deployment for HuskyAI\nconfirmed assumption : All services within the trust boundary validate tokens via Auth Service\n",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 1675,
              "y": 330
            },
            "size": {
              "width": 855,
              "height": 615
            },
            "attrs": {
              "label": {
                "text": "Production Trust Zone"
              }
            },
            "shape": "trust-boundary-box",
            "id": "prod-zone",
            "zIndex": -2,
            "data": {
              "type": "tm.BoundaryBox",
              "name": "Production Trust Zone",
              "description": "Internal VPC with the production deployment of HuskyAI\nconfirmed assumption : All services within the trust boundary validate tokens via Auth Service\n",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            }
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "HTTPS",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS",
              "description": "Transfer data from Azure Cognitive Services to Gather Images Application in Python.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Information Disclosure via Man-in-the-Middle",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Information Disclosure",
                  "description": "The HTTPS flow from Azure Cognitive Services to Gather Images Application is encrypted, but misconfigured TLS or certificate validation could allow eavesdropping.",
                  "mitigation": "Enforce TLS 1.2+, validate server certificates, and use certificate pinning for critical external services.",
                  "modelType": "STRIDE",
                  "id": "ea728049-a67a-4491-8566-16b1cf27ea53"
                }
              ]
            },
            "source": {
              "cell": "azure-cognitive-services",
              "port": ""
            },
            "target": {
              "cell": "gather-images",
              "port": ""
            },
            "vertices": [],
            "id": "azure-cognitive-gather-images",
            "zIndex": 0
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "imports",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "imports",
              "description": "Transfer data from Third Party tools and ML libraries to Gather Images Application in Python.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "third-party-tools",
              "port": ""
            },
            "target": {
              "cell": "gather-images",
              "port": ""
            },
            "vertices": [],
            "id": "third-party-tools-gather-images",
            "zIndex": 1
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "imports",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "imports",
              "description": "Transfer data from Third Party tools and ML libraries to Jupyter Notebook.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "third-party-tools",
              "port": ""
            },
            "target": {
              "cell": "jupyter",
              "port": ""
            },
            "vertices": [],
            "id": "third-party-tools-jupyter-notebook",
            "zIndex": 2
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "VS Code (SSH)",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "VS Code (SSH)",
              "description": "Transfer data from Engineer to Gather Images Application in Python.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Spoofing of Engineer Identity",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "The VS Code (SSH) flow from Engineer to Gather Images Application relies on SSH keys. If keys are compromised, an attacker could spoof the engineer's identity.",
                  "mitigation": "Enforce MFA for SSH, use strong passphrases, and regularly rotate SSH keys.",
                  "modelType": "STRIDE",
                  "id": "2c58f2d9-544c-453b-ae55-7bb8a7511ba6"
                }
              ]
            },
            "source": {
              "cell": "engineer",
              "port": ""
            },
            "target": {
              "cell": "gather-images",
              "port": ""
            },
            "vertices": [],
            "id": "engineer-gather-images",
            "zIndex": 3
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "VS Code (SSH)",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "VS Code (SSH)",
              "description": "Transfer code and ML models from Engineer locally to Jupyter Notebook.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Repudiation of Model Changes",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "The Engineer can transfer code and models to Jupyter Notebook via SSH. Without proper auditing, the engineer could deny making harmful changes.",
                  "mitigation": "Implement detailed audit logs for all SSH sessions and model modifications, with non-repudiation mechanisms.",
                  "modelType": "STRIDE",
                  "id": "a1e28783-dc2f-4c3a-be95-239c2f51336a"
                }
              ]
            },
            "source": {
              "cell": "engineer",
              "port": ""
            },
            "target": {
              "cell": "jupyter",
              "port": ""
            },
            "vertices": [],
            "id": "engineer-jupyter-notebook",
            "zIndex": 4
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "stores",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "stores",
              "description": "Transfer images from Gather Images Application to Training and Validation Images.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Tampering of Stored Images",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Tampering",
                  "description": "The 'stores' flow from Gather Images Application to Training and Validation Images is unencrypted (isEncrypted: false). An attacker on the network could tamper with images during storage.",
                  "mitigation": "Use encrypted connections (e.g., HTTPS) for all data transfers to storage, and validate data integrity upon write/read.",
                  "modelType": "STRIDE",
                  "id": "21983b67-61c7-47f5-a531-03e73a5cbbdc"
                }
              ]
            },
            "source": {
              "cell": "gather-images",
              "port": ""
            },
            "target": {
              "cell": "training-images-blob",
              "port": ""
            },
            "vertices": [],
            "id": "gather-images-training-images",
            "zIndex": 5
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "loads",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "loads",
              "description": "API Key Storage to Gather Images Application in Python.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Information Disclosure of API Keys in Transit",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The 'loads' flow from API Key Storage to Gather Images Application is unencrypted (isEncrypted: false). API keys could be intercepted if transmitted over an insecure channel.",
                  "mitigation": "Ensure all secrets are transmitted over encrypted channels (e.g., TLS) and use secure protocols for secrets retrieval.",
                  "modelType": "STRIDE",
                  "id": "89bb5af6-181e-4a32-b4cb-5308dc035bd4"
                }
              ]
            },
            "source": {
              "cell": "api-key-storage",
              "port": ""
            },
            "target": {
              "cell": "gather-images",
              "port": ""
            },
            "vertices": [],
            "id": "api-key-storage-gather-images",
            "zIndex": 6
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "processes",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "processes",
              "description": "Load from Training and Validation Images to Jupyter Notebook.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "training-images-blob",
              "port": ""
            },
            "target": {
              "cell": "jupyter",
              "port": ""
            },
            "vertices": [],
            "id": "training-images-jupyter-notebook",
            "zIndex": 7
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "package",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "package",
              "description": "Transfer data from Machine Learning Model to Deployment.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "ml-models",
              "port": ""
            },
            "target": {
              "cell": "deployment-service",
              "port": ""
            },
            "vertices": [],
            "id": "ml-models-deployment-service",
            "zIndex": 8
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "save.h5",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "save.h5",
              "description": "Transfer final model from Jupyter Notebook to Machine Learning Model.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Tampering of Model Serialization",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The 'save.h5' flow from Jupyter Notebook to Machine Learning Model store is unencrypted. An attacker could intercept and modify the model during serialization or transfer.",
                  "mitigation": "Encrypt model files during transfer, use secure protocols, and verify checksums upon storage.",
                  "modelType": "STRIDE",
                  "id": "73b5f780-164d-403d-b1d9-6998f736993d"
                }
              ]
            },
            "source": {
              "cell": "jupyter",
              "port": ""
            },
            "target": {
              "cell": "ml-models",
              "port": ""
            },
            "vertices": [],
            "id": "jupyter-notebook-ml-model",
            "zIndex": 9
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "package",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "package",
              "description": "Transfer from Machine Learning Model Blob to Deployment Service.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "ml-models-blob",
              "port": ""
            },
            "target": {
              "cell": "deployment-service",
              "port": ""
            },
            "vertices": [],
            "id": "ml-model-deployment-service",
            "zIndex": 10
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "package",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "package",
              "description": "Transfer data from Source Code and Configuration to Deployment.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "source-code-config-storage",
              "port": ""
            },
            "target": {
              "cell": "deployment-service",
              "port": ""
            },
            "vertices": [],
            "id": "source-code-deployment",
            "zIndex": 11
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "HTTPS",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS",
              "description": "Transfer from User to API Gateway.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Spoofing of External Users",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Spoofing",
                  "description": "The HTTPS flow from User to API Gateway lacks described authentication. Attackers could spoof user identities to access services.",
                  "mitigation": "Implement strong user authentication (e.g., OAuth 2.0) and rate limiting to prevent abuse.",
                  "modelType": "STRIDE",
                  "id": "04786e66-3d66-4017-880e-8d46d8ff1585"
                },
                {
                  "title": "Denial of Service from External Users",
                  "status": "Open",
                  "severity": "High",
                  "type": "Denial of Service",
                  "description": "The public-facing API Gateway is vulnerable to DoS attacks from malicious users overwhelming the service with requests.",
                  "mitigation": "Deploy DDoS protection, rate limiting, and auto-scaling to mitigate impact.",
                  "modelType": "STRIDE",
                  "id": "0a1a6566-4946-45ce-9138-3e7eb910096d"
                }
              ]
            },
            "source": {
              "cell": "user",
              "port": ""
            },
            "target": {
              "cell": "api-gateway",
              "port": ""
            },
            "vertices": [],
            "id": "user-api-gateway",
            "zIndex": 12
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "update",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "update",
              "description": "Transfer data from Bastion to API Gateway.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "bastion",
              "port": ""
            },
            "target": {
              "cell": "api-gateway",
              "port": ""
            },
            "vertices": [],
            "id": "bastion-api-gateway",
            "zIndex": 13
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "HTTPS",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "HTTPS",
              "description": "Transfer data from API Gateway to Simple Python Web Server.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Information Disclosure via Internal API",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information Disclosure",
                  "description": "The HTTPS flow from API Gateway to Simple Python Web Server is unencrypted (isEncrypted: false). Sensitive data or model inferences could be intercepted on the internal network.",
                  "mitigation": "Encrypt all internal traffic using TLS or VPNs to protect against eavesdropping.",
                  "modelType": "STRIDE",
                  "id": "ca22a417-a732-49a6-b006-563ce8974c03"
                }
              ]
            },
            "source": {
              "cell": "api-gateway",
              "port": ""
            },
            "target": {
              "cell": "web-service",
              "port": ""
            },
            "vertices": [],
            "id": "api-gateway-web-server",
            "zIndex": 14
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "update",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "update",
              "description": "Transfer data from Bastion to Simple Python Web Server.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "bastion",
              "port": ""
            },
            "target": {
              "cell": "web-service",
              "port": ""
            },
            "vertices": [],
            "id": "bastion-web-server",
            "zIndex": 15
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "loads",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "loads",
              "description": "Transfer sensitive data from Stored Machine Learning Model to Simple Python Web Server.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Tampering of Model Loading",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": "The 'loads' flow from Stored Machine Learning Model to Simple Python Web Server is unencrypted. An attacker could tamper with the model as it is loaded into the web server.",
                  "mitigation": "Use encrypted storage and secure transfer protocols, and verify model integrity checksums upon loading.",
                  "modelType": "STRIDE",
                  "id": "7b0b9491-ac2b-4d41-a040-5ea18f304677"
                }
              ]
            },
            "source": {
              "cell": "ml-models-blob",
              "port": ""
            },
            "target": {
              "cell": "web-service",
              "port": ""
            },
            "vertices": [],
            "id": "stored-ml-model-web-server",
            "zIndex": 16
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "SSH",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SSH",
              "description": "Transfer sensitive data from Deployment Service to Bastion",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Elevation of Privilege via Deployment Channel",
                  "status": "Open",
                  "severity": "High",
                  "type": "Elevation of Privilege",
                  "description": "The SSH flow from Deployment Service to Bastion provides a pathway for privilege escalation if the deployment process is compromised.",
                  "mitigation": "Restrict SSH access to the Bastion, use network segmentation, and monitor for unusual deployment activities.",
                  "modelType": "STRIDE",
                  "id": "5a7fc0c7-9cb8-4165-80f8-8d68cd413e7e"
                }
              ]
            },
            "source": {
              "cell": "deployment-service",
              "port": ""
            },
            "target": {
              "cell": "bastion",
              "port": ""
            },
            "vertices": [],
            "id": "deployment-bastion",
            "zIndex": 17
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "update",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "update",
              "description": "Transfer sensitive data from Bastion to Stored Machine Learning Model.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "bastion",
              "port": ""
            },
            "target": {
              "cell": "ml-models-blob",
              "port": ""
            },
            "vertices": [],
            "id": "bastion-ml-model",
            "zIndex": 18
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "SSH",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "SSH",
              "description": "Transfer data from Infrastructure Admin to Bastion.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Spoofing of Infrastructure Admin",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "The SSH flow from Infrastructure Admin to Bastion relies on key-based authentication. Stolen keys could allow an attacker to spoof the admin and gain full system access.",
                  "mitigation": "Enforce MFA, use jump hosts with strict access controls, and regularly audit administrative access.",
                  "modelType": "STRIDE",
                  "id": "fdfcee46-7bcc-44ee-91cd-b2d719543386"
                }
              ]
            },
            "source": {
              "cell": "infrastructure-admin",
              "port": ""
            },
            "target": {
              "cell": "bastion",
              "port": ""
            },
            "vertices": [],
            "id": "admin-bastion",
            "zIndex": 19
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "update",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "update",
              "description": "Transfer sensitive data from Bastion to Stored Machine Learning Model.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "bastion",
              "port": ""
            },
            "target": {
              "cell": "ml-models-blob",
              "port": ""
            },
            "vertices": [],
            "id": "bastion-stored-ml-model",
            "zIndex": 20
          },
          {
            "attrs": {
              "line": {
                "stroke": "red",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "Transfer sensitive data from Authorized Keys Storage to Bastion.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": [
                {
                  "title": "Information Disclosure of SSH Keys in Transit",
                  "status": "Open",
                  "severity": "High",
                  "type": "Information Disclosure",
                  "description": "The flow from Authorized Keys Storage to Bastion is encrypted (SSH), but if the storage or retrieval process is insecure, keys could be leaked.",
                  "mitigation": "Use a secure secrets management service with encryption in transit and at rest, and audit all access to keys.",
                  "modelType": "STRIDE",
                  "id": "8bf3d6bc-4a24-4886-a011-ce731d6b5478"
                }
              ]
            },
            "source": {
              "cell": "secret-key-storage",
              "port": ""
            },
            "target": {
              "cell": "bastion",
              "port": ""
            },
            "vertices": [],
            "id": "authorized-keys-bastion",
            "zIndex": 21
          },
          {
            "attrs": {
              "line": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "shape": "flow",
            "width": 200,
            "height": 100,
            "labels": [
              {
                "markup": [
                  {
                    "tagName": "ellipse",
                    "selector": "labelBody"
                  },
                  {
                    "tagName": "text",
                    "selector": "labelText"
                  }
                ],
                "attrs": {
                  "labelText": {
                    "text": "imports",
                    "textAnchor": "middle",
                    "textVerticalAnchor": "middle"
                  },
                  "labelBody": {
                    "ref": "labelText",
                    "refRx": "50%",
                    "refRy": "60%",
                    "fill": "#fff",
                    "strokeWidth": 0
                  }
                },
                "position": {
                  "distance": 0.5,
                  "args": {
                    "keepGradient": true,
                    "ensureLegibility": true
                  }
                }
              }
            ],
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "imports",
              "description": "Transfer data from Third Party tools and ML libraries to Simple Python Web Server.",
              "outOfScope": false,
              "isTrustBoundary": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": true,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "source": {
              "cell": "third-party-tools",
              "port": ""
            },
            "target": {
              "cell": "web-service",
              "port": ""
            },
            "vertices": [],
            "id": "third-party-tools-web-server",
            "zIndex": 22
          }
        ]
      }
    ],
    "diagramTop": 0,
    "reviewer": "",
    "threatTop": 8
  },
  "version": "2.5.0",
  "compatibility": {
    "version": "1.0.1",
    "description": "A machine learning system to classify Huskies vs dogs",
    "frozen": false,
    "release_docs_link": "https://github.com/wunderwuzzi23/huskyai",
    "reviewed_at": "2025-05-28",
    "repo_link": "https://github.com/wunderwuzzi23/huskyai"
  }
}